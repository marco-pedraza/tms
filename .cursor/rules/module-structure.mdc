---
description: Frontend module structure patterns
globs: app/**/*.tsx,app/**/*.ts
alwaysApply: false
---

# Module Structure

> **ðŸ“– See `AGENTS.md` for complete frontend patterns including hooks, components, and data fetching**

## Essential Description

Each module follows consistent structure separating components, hooks, and pages. Use React Query for data fetching, TanStack Form for forms, and next-intl for i18n.

## File Structure

```
app/module-name/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ module-name-table.tsx
â”‚   â”œâ”€â”€ module-name-form.tsx
â”‚   â”œâ”€â”€ module-name-skeleton.tsx
â”‚   â””â”€â”€ module-name-not-found.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ use-query-module-name.ts
â”‚   â”œâ”€â”€ use-module-name-mutations.ts
â”‚   â””â”€â”€ use-module-name-details-params.ts
â”œâ”€â”€ [id]/
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ edit/page.tsx
â”œâ”€â”€ new/page.tsx
â””â”€â”€ page.tsx
```

## Practical Examples

### Query Hook

```typescript
export default function useQueryEntity({ entityId, enabled = true }) {
  const queryClient = useQueryClient();

  return useQuery({
    queryKey: ['module-name', entityId],
    queryFn: () => getEntity({ id: entityId }),
    enabled,
    initialData: () => {
      const cached = queryClient.getQueryData(['module-name']);
      return cached?.data?.find((e: Entity) => e.id === entityId);
    },
  });
}
```

### Mutations Hook

```typescript
export default function useEntityMutations() {
  const queryClient = useQueryClient();
  const router = useRouter();
  const t = useTranslations('module-name');

  const create = useMutation({
    mutationFn: createEntity,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['module-name'] });
      toast.success(t('messages.created'));
      router.push(routes.module.list);
    },
  });

  return { create, update, delete: deleteMutation };
}
```

### Form Component

```typescript
'use client';

export default function EntityForm({ defaultValues, onSubmit }: Props) {
  const form = useForm({
    defaultValues,
    onSubmit: async (values) => {
      await onSubmit(values);
    },
  });

  return (
    <form onSubmit={form.handleSubmit}>
      {/* form fields */}
    </form>
  );
}
```

### Layout with Validation

```typescript
'use client';

export default function EntityLayout({ children }: { children: React.ReactNode }) {
  const { entityId, isValidId } = useEntityDetailsParams();
  const { status } = useQueryEntity({ entityId, enabled: isValidId });

  if (!isValidId) return <EntityNotFound />;
  if (status === 'error') return <LoadError />;

  return children;
}
```

## References

- See `AGENTS.md` section "Frontend Patterns" for complete patterns
- See `AGENTS.md` section "Hooks Pattern" for hook details
- See `AGENTS.md` section "Component Patterns" for components
